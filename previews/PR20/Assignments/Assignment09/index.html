<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Assignment09 · BISC195.jl</title><link rel="canonical" href="https://wellesley-bisc195.github.io/BISC195.jl/Assignments/Assignment09/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/admonitions.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="BISC195.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="BISC195.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">BISC195.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../Syllabus/">Syllabus</a></li><li><span class="tocitem">Lesson 1 - Getting Started</span><ul><li><a class="tocitem" href="../../Lessons/Lesson1/">Lesson docs</a></li><li><a class="tocitem" href="../Assignment01/">Assignment01</a></li></ul></li><li><span class="tocitem">Lesson 2 - Data Types and Functions</span><ul><li><a class="tocitem" href="../../Lessons/Lesson2/">Lesson docs</a></li><li><a class="tocitem" href="../Assignment02/">Assignment02</a></li></ul></li><li><span class="tocitem">Lesson 3 - Building functions and composition</span><ul><li><a class="tocitem" href="../../Lessons/Lesson3/">Lesson docs</a></li><li><a class="tocitem" href="../Assignment03/">Assignment03</a></li></ul></li><li><span class="tocitem">Lesson 4 - Building functions and composition</span><ul><li><a class="tocitem" href="../../Lessons/Lesson4/">Lesson docs</a></li><li><a class="tocitem" href="../Assignment04/">Assignment04</a></li></ul></li><li><span class="tocitem">Lesson 5 - Arrays</span><ul><li><a class="tocitem" href="../../Lessons/Lesson5/">Lesson docs</a></li><li><a class="tocitem" href="../Assignment05/">Assignment05</a></li></ul></li><li><span class="tocitem">Lesson 6 - Miscellany</span><ul><li><a class="tocitem" href="../../Lessons/Lesson6/">Lesson docs</a></li><li><a class="tocitem" href="../Assignment06/">Assignment06</a></li></ul></li><li><span class="tocitem">Lesson 7 - Code re-use: packages and environments</span><ul><li><a class="tocitem" href="../../Lessons/Lesson7/">Lesson docs</a></li><li><a class="tocitem" href="../Assignment07/">Assignment07</a></li></ul></li><li><span class="tocitem">Lesson 8 - Putting it all togeher</span><ul><li><a class="tocitem" href="../../Lessons/Lesson8/">Lesson docs</a></li><li><a class="tocitem" href="../Assignment08/">Assignment08</a></li></ul></li><li><span class="tocitem">Lesson 9 - Analyzing coronavirus genomes</span><ul><li><a class="tocitem" href="../../Lessons/Lesson9/">Lesson docs</a></li><li class="is-active"><a class="tocitem" href>Assignment09</a><ul class="internal"><li><a class="tocitem" href="#Using-Revise.jl-during-development"><span>Using <code>Revise.jl</code> during development</span></a></li><li><a class="tocitem" href="#Continuing-CoV-analysis"><span>Continuing CoV analysis</span></a></li><li><a class="tocitem" href="#Kmer-analysis-of-coronavirus-genomes"><span>Kmer analysis of coronavirus genomes</span></a></li><li><a class="tocitem" href="#Unique-kmers"><span>Unique kmers</span></a></li><li><a class="tocitem" href="#Completion-Checklist"><span>Completion Checklist</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../Assignments/">Assignment Index</a></li><li><a class="tocitem" href="../../Lectures/Lectures/">Lecture Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Lesson 9 - Analyzing coronavirus genomes</a></li><li class="is-active"><a href>Assignment09</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Assignment09</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/wellesley-bisc195/BISC195.jl/blob/master/docs/src/Assignments/Assignment09.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="assignment09"><a class="docs-heading-anchor" href="#assignment09">Assignment 09</a><a id="assignment09-1"></a><a class="docs-heading-anchor-permalink" href="#assignment09" title="Permalink"></a></h1><p><a href="#assignment09"><img src="https://img.shields.io/badge/09-Description-blue?style=for-the-badge&amp;logo=open%20badges" alt="Assignment 09 - Description"/></a> <a href="#assignment09"><img src="https://img.shields.io/badge/Due-7%2F20%2F2020-orange?style=for-the-badge&amp;logo=open%20badges" alt="Assignment 09 - Due"/></a></p><p>Let&#39;s continue with our analysis of SARS-CoV2 genomes. But before we do - I want to add one more trick to your workflow. In the following code examples the <strong>package</strong> repo from assignment 8 is called <code>BioinformaticsBISC195.jl</code>, and the <strong>analysis</strong> repo is called <code>CoVAnalsyis</code>.</p><h2 id="Using-Revise.jl-during-development"><a class="docs-heading-anchor" href="#Using-Revise.jl-during-development">Using <code>Revise.jl</code> during development</a><a id="Using-Revise.jl-during-development-1"></a><a class="docs-heading-anchor-permalink" href="#Using-Revise.jl-during-development" title="Permalink"></a></h2><p>Typically, when you load a package in julia, that package becomes frozen in amber. That is, if you edit the source code after <code>using</code> the package, it is not easy to get these changes to show up in your julia session without restarting julia.</p><p>For example, start a julia REPL (not in VS Code[1]), change directories to your analysis repo, activate the environment, then load your bioinformatics package.</p><pre><code class="language-julia">julia&gt; cd(&quot;repos/CoVAnalysis&quot;)

@v1.4&gt; activate .

julia&gt; using BioinformaticsBISC195</code></pre><p>You should now have access to any functions exported from your package.</p><pre><code class="language-julia">julia&gt; complement(&#39;A&#39;)
&#39;T&#39;: ASCII/Unicode U+0054 (category Lu: Letter, uppercase)</code></pre><p><strong>BUT</strong> changing anything in your package repo is now blocked. For example, add and export a new function, or change an existing function to do something different (I changed my <code>complement</code> function to always return <code>42</code>).</p><p>Even if you repeat <code>using BioinformaticsBISC195</code>, these changes will not be incorporated into your julia session.</p><p>Having to restart your julia session each time you change something would make package development a nightmare, but thankfully there&#39;s a better way.</p><p>The <a href="https://timholy.github.io/Revise.jl/stable/"><code>Revise.jl</code> package</a> comes to the resuce. It&#39;s a bit magical - to be honest, I don&#39;t understand how it works, but if you load it (<code>using Revise</code>) <em>before</em> loading your package, then new changes you enter will be incorporated into your running julia session. This package is so widely used that the julia VS code extension loads it by default (which is why I said not to open a REPL in VS Code).</p><p>Try it out - restart julia, then repeat the above process, but do <code>using Revise</code> right before <code>using BioinformaticsBISC195</code>.</p><p>Note: don&#39;t forget to revert the changes you made to your package code.</p><p>With this in mind, you&#39;re ready to continue working on coronavirus analysis. As you go forward, put reusable code (eg new functions and types) into your package repository, while analysis-specific code (eg loading files, calculating stats, plots) should go into your analysis repo.</p><p>Don&#39;t forget to describe the analyses you&#39;re performing in your markdown notebooks.</p><h2 id="Continuing-CoV-analysis"><a class="docs-heading-anchor" href="#Continuing-CoV-analysis">Continuing CoV analysis</a><a id="Continuing-CoV-analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Continuing-CoV-analysis" title="Permalink"></a></h2><p>In the previous lesson, we calculated the mean and standard deviation of sequence lengths. But mean and standard deviation are really only descriptive if the lengths of the sequences follow a <a href="https://en.wikipedia.org/wiki/Normal_distribution">normal distribution</a>.</p><p>The <code>minimum()</code> and <code>maximum()</code> functions take vectors as arguments, and return the smallest and largest values respectively.</p><div class="admonition is-category-practice"><header class="admonition-header">To Do</header><div class="admonition-body"><p>Use the <code>minimum()</code> and <code>maximum()</code> functions to find the length of the shortest and longest coronavirus genome in your dataset. Do the values make sense, given the mean length?</p></div></div><h3 id="Identifying-outliers"><a class="docs-heading-anchor" href="#Identifying-outliers">Identifying outliers</a><a id="Identifying-outliers-1"></a><a class="docs-heading-anchor-permalink" href="#Identifying-outliers" title="Permalink"></a></h3><p>In the dataset I downloaded, there are several genomes that are very small - less than 1000 bases when the mean length is closer to 30k bases.</p><p>How did I figure this out? I promise I didn&#39;t look at the genome file by hand!</p><p>One of the easiest ways to get an overview of a dataset is to make some exploratory plots. For this, we can use the <a href="http://docs.juliaplots.org/latest/"><code>Plots.jl</code></a> package, which makes it very easy to make plots with your data in julia.</p><pre><code class="language-julia"># having previously created a vector with the lengths of my sequences...
using Plots

histogram(seq_lengths)</code></pre><p><img src="../../assets/img/coronavirus_lengths.png" alt="coronavirus genome lengths"/></p><div class="admonition is-category-practice"><header class="admonition-header">To Do</header><div class="admonition-body"><ol><li>Use the <code>Plots</code> package to create a histogram of your coronavirus genome lengths.</li><li>Look at the documentation for the <code>Plots.jl</code> package and see if you can figure out how to remove the legend and add more descriptive axis labels to this plot</li></ol></div></div><p>I&#39;d expect most coronaviruses to have similar length genomes, so anything less than 25k bases is probably a mistake. Take note! Datasets like this are never perfect - it&#39;s always worth your time to make sure there aren&#39;t errors.</p><div class="admonition is-category-practice"><header class="admonition-header">To Do</header><div class="admonition-body"><p>Filter your sequences to remove any that have a length of less than 25k bases. There are a couple of different ways to do this - but keep in mind that, if the headers and sequences from your fasta file are separate, you need to make sure that you remove the headers that correspond to short sequences as well.</p><p>Some possibilities:</p><ol><li>Add a filter to your <code>parse_fasta()</code> function. This is not ideal, since it makes the function less generalizable to other problems.</li><li>Find the index of all the sequences that are less than 25K bases long, then remove the items at those indices from the sequence vector and the headers vector. Take a look at the <code>findall()</code> function if you plan to take this path. Warning: if you remove things one by one, you may change the indices of other things in the vector.</li><li>Loop through the sequences, and, if they are long enough, push them into a new vector. Again - be sure to take care of the headers as well.</li><li>Find the index of all of the sequences that are <em>longer</em> than 25k bases, and then take a slice of the original vector. Again, <code>findall()</code> may be useful here.</li></ol><p>Whatever you do, you should ensure that:</p><ol><li>The <code>minimum()</code> of the sequence length is actually &gt; 25k bases.</li><li>If your sequence and header vectors are separate, they should have the same length.</li></ol></div></div><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>You can use <code>@assert</code> to make sure that your code did what you expect. <code>@assert</code> followed by a boolean expression will throw an error if the expression is <code>false</code>.</p><pre><code class="language-julia">julia&gt; @assert 1 == 1

julia&gt; @assert 1 == 2
ERROR: AssertionError: 1 == 2
Stacktrace:
[1] top-level scope at REPL[13]:1</code></pre><p>So you might do <code>@assert length(header_vector) == length(sequence_vector)</code> for example.</p></div></div><h3 id="Plot-the-result"><a class="docs-heading-anchor" href="#Plot-the-result">Plot the result</a><a id="Plot-the-result-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-the-result" title="Permalink"></a></h3><div class="admonition is-category-practice"><header class="admonition-header">To Do</header><div class="admonition-body"><p>Create a new histogram that shows the distribution of filtered sequences. It should look something like this:</p><p><img src="../../assets/img/filtered_coronavirus_lengths.png" alt="filtered histogram"/></p></div></div><h2 id="Kmer-analysis-of-coronavirus-genomes"><a class="docs-heading-anchor" href="#Kmer-analysis-of-coronavirus-genomes">Kmer analysis of coronavirus genomes</a><a id="Kmer-analysis-of-coronavirus-genomes-1"></a><a class="docs-heading-anchor-permalink" href="#Kmer-analysis-of-coronavirus-genomes" title="Permalink"></a></h2><p>The best way to reason about how closely related two sequences are is to use some &quot;<a href="https://en.wikipedia.org/wiki/Metric_(mathematics)">distance metric</a>&quot;. Sequences that are closer together are inferred to share a common ancestor more recently than sequences that are further apart.</p><p>The most widely-used distance metrics typically come from <a href="https://en.wikipedia.org/wiki/Sequence_alignment#Multiple_sequence_alignment">doing an alignment</a>, but the algorithms for aligning sequences are a bit beyond the scope of this course.</p><p>Instead, we can do a quick-and-dirty analysis by comparing the unique kmers in a sequence. Look back to <a href="../Assignment04/#assignment04">Assignment04</a>, where you created a function to count the kmers in a sequence.</p><h2 id="Unique-kmers"><a class="docs-heading-anchor" href="#Unique-kmers">Unique kmers</a><a id="Unique-kmers-1"></a><a class="docs-heading-anchor-permalink" href="#Unique-kmers" title="Permalink"></a></h2><p>Here, we don&#39;t need to count the kmers, we just want to know which kmers of a given length are present. You might find it useful to use the <code>Set</code> type, which is an unordered collection of unique elements:</p><pre><code class="language-julia">julia&gt; my_set = Set([1,1,1,1,1,1,2,2,2,2,2])
Set{Int64} with 2 elements:
  2
  1

julia&gt; push!(my_set, 3)
Set{Int64} with 3 elements:
  2
  3
  1

julia&gt; push!(my_set, 3) # since 3 is already in it, nothing changes
Set{Int64} with 3 elements:
  2
  3
  1

julia&gt; union!(my_set, [3,3,3,3,3,4,4,4,4,4,4])
Set{Int64} with 4 elements:
  4
  2
  3
  1</code></pre><div class="admonition is-category-practice"><header class="admonition-header">To Do</header><div class="admonition-body"><p>Add a function to your bioinformatics package that takes 2 arguments - a sequence and an integer (<code>k</code>), and returns all of the unique kmers of length <code>k</code></p><p>Do not keep kmers with ambiguous bases (anything other than <code>A</code>, <code>T</code>, <code>G</code>, or <code>C</code>).</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>This function may take a long time to run on all of your genomes. Use a small subset of genomes and/or the <code>ex1.fasta</code> file while you&#39;re working on it to make sure it works before trying to run it with all of your genomes.</p></div></div></div></div><h3 id="Comparing-unique-kmers"><a class="docs-heading-anchor" href="#Comparing-unique-kmers">Comparing unique kmers</a><a id="Comparing-unique-kmers-1"></a><a class="docs-heading-anchor-permalink" href="#Comparing-unique-kmers" title="Permalink"></a></h3><p>We can now use set theory to compare genomes to one another.</p><p>The &quot;union&quot; of two or more sets is the set containing all of the elements found in any set.</p><pre><code class="language-julia">julia&gt; s1 = Set([1,2,3]); s2 = Set([2,3,4]);

julia&gt; union(s1, s2)
Set{Int64} with 4 elements:
  4
  2
  3
  1</code></pre><p>The &quot;intersection&quot; of two or more sets is the set of elements that occur in all of the sets.</p><pre><code class="language-julia">julia&gt; intersect(s1, s2)
Set{Int64} with 2 elements:
  2
  3</code></pre><p>While the &quot;difference&quot; refers the the elements of the first set but not in any of the other sets.</p><pre><code class="language-julia">julia&gt; setdiff(s1, s2)
Set{Int64} with 1 element:
  1

julia&gt; setdiff(s2, s1)
Set{Int64} with 1 element:
  4</code></pre><p>A distance metric should have the following features:</p><ul><li>Should be a positive number between 0 and 1</li><li>Identical things should have a distance of 0</li><li>Things with absolutely no similarity should have a distance of 1</li></ul><p>To do this with our kmer sets, we can define a distance metric that is <code>1 - (length of intersection / length of union)</code>.</p><p>Or alternatively, <code>((length of set1 - set2) + (length of set2 - set1)) / length of union</code>.</p><div class="admonition is-category-practice"><header class="admonition-header">To Do</header><div class="admonition-body"><p>Add a function to your bioinformatics package that takes two kmer sets and calculates the distance between them.</p><p>In the next lesson, we&#39;ll use the distances between sequences to learn something about the evolution of SARS-related coronaviruses.</p></div></div><h2 id="Completion-Checklist"><a class="docs-heading-anchor" href="#Completion-Checklist">Completion Checklist</a><a id="Completion-Checklist-1"></a><a class="docs-heading-anchor-permalink" href="#Completion-Checklist" title="Permalink"></a></h2><ul><li>[ ] Further description of sequence lengths<ul><li>[ ] get the smallest and largest sequence length</li><li>[ ] use <code>histogram()</code> from <code>Plots</code> on sequence lengths</li></ul></li><li>[ ] Filter sequences to remove anything &lt; 25k basepairs long<ul><li>[ ] Create histogram of filtered sequence lengths</li></ul></li><li>[ ] Unique kmer function that discards kmers with ambiguous bases</li><li>[ ] Kmer set distance function that returns a distance metric</li></ul><p>[1]: The Julia language extension of VS Code loads <code>Revise.jl</code> automatically if you have it installed</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../Lessons/Lesson9/">« Lesson docs</a><a class="docs-footer-nextpage" href="../Assignments/">Assignment Index »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 21 December 2020 17:36">Monday 21 December 2020</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
